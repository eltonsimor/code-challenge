{
  "apiVersion":"extensions/v1beta1",
  "kind":"Deployment",
  "metadata":{
    "name":"code-challenge-deployment"
  },
  "spec":{
    "replicas":2,
    "strategy":{
      "rollingUpdate":{
        "maxSurge":1,
        "maxUnavailable":0
      }
    },
    "template":{
      "metadata":{
        "labels":{
          "workstations":"ingress",
          "workstations-ingress-http-alt":"allow",
          "workstations-ingress-https-alt":"allow",
          "internet":"egress",
          "internet-egress-http":"allow",
          "internet-egress-https":"allow",
          "app":"code-challenge",
          "tier":"backend"
        }
      },
      "spec":{
        "dnsConfig":{
          "nameservers":[
            "8.8.8.8",
            "8.8.4.4"
          ]
        },
        "containers":[
          {
            "name":"code-challenge",
            "image":"eltonsimor/code-challenge:latest",
            "imagePullPolicy":"Always",
            "ports":[
              {
                "containerPort":8080
              }
            ],
            "resources":{
              "requests":{
                "memory":"0.5G",
                "cpu":"0.5"
              },
              "limits":{
                "memory":"1G",
                "cpu":"1"
              }
            },
            "readinessProbe":{
              "httpGet":{
                "scheme":"HTTP",
                "path":"/code-challenge/health",
                "port":8080
              },
              "initialDelaySeconds":120,
              "periodSeconds":5,
              "timeoutSeconds":5,
              "successThreshold":1,
              "failureThreshold":10
            },
            "livenessProbe":{
              "httpGet":{
                "scheme":"HTTP",
                "path":"/code-challenge/health",
                "port":8080
              },
              "initialDelaySeconds":120,
              "periodSeconds":60,
              "timeoutSeconds":10,
              "successThreshold":1,
              "failureThreshold":3
            },
            "env":[
              {
                "name":"JAVA_OPTS",
                "value":"-XX:MaxMetaspaceSize=512m -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Dspring.profiles.active=prod -Duser.timezone=Brazil/East"
              }
            ]
          }
        ]
      }
    }
  }
}